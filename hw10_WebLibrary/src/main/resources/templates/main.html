<!DOCTYPE html>
<!--<html lang="en" xmlns:th="http://www.thymeleaf.org">-->
<head>
    <meta charset="UTF-8"/>
    <title>List of all persons</title>
    <style type="text/css">
        body {
            padding: 50px;
        }

        .books {
            border: 1px solid steelblue;
            width: 300px;
            border-collapse: collapse;
        }

        .persons tr td, th {
            padding: 5px;
            border: 1px solid steelblue;
        }

        .persons td:last-child, td:first-child {
            width: 50px;
        }
    </style>
    <script src="/webjars/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
</head>
<body id="body">
<!--<h3 th:text="#{lang-switcher-header}">Select language</h3>-->
<!--<div>-->
<!--    <div><a href="#" th:href="@{/(lang=en)}" th:text="#{en-lang-switch-button-caption}">Language - EN</a></div>-->
<!--    <div><a href="#" th:href="@{/(lang=ru)}" th:text="#{ru-lang-switch-button-caption}">Language - RU</a></div>-->
<!--</div>-->
<h1>Entity:</h1>

<script>
    function outputCharacter(json) {
        var body = document.getElementsByTagName('body')[0];
        var table = document.createElement('table');
        var thead = document.createElement('thead');
        var tbody = document.createElement('tbody')
        thead.innerHTML =`
        <tr>
             <th>ID</th>
             <th>Name</th>
             <th>Action</th>
        </tr>`
        tbody.innerHTML=``
        json.forEach(book => tbody.innerHTML+=`
                <tr>
                  <td>${book.id}</td>
                  <td>${book.title}</td>
                  <td><button onclick = "deleteBooks(${book.id})">delete</button></td>
                  </tr>`);
        table.appendChild(thead);
        table.appendChild(tbody);
        body.appendChild(table)
    }
</script>
<script>
    function test(){
        var body = document.getElementsByTagName('body')[0];
        var table = document.createElement('table');
        var thead = document.createElement('thead');
        thead.setAttribute("id","thead2")
        document.getElementById("thead2").innerHTML=``
        thead.innerHTML =`
        <tr>
             <th>ID</th>
             <th>Name</th>
             <th>Action</th>
        </tr>`

        table.appendChild(thead);


// Adding the entire table to the body tag
        body.appendChild(table)
    }
</script>
<script>
    function test2(){
        document.getElementsByTagName("table")[0].deleteTHead();
    }
</script>
<script>
    function getBooks() {
        $.ajax({
            type: 'GET',
            url: '/api/books',
            success: (json) => {
                outputCharacter(json)
            }
        })
    }
</script>
<script>
    function deleteBooks(id) {
        $.ajax({
            type: 'DELETE',
            url: '/api/books/'+id,
        }).done(function (){
            test2();
            getBooks();
        })
    }
</script>
<button style = "width: 400px" onclick = "getBooks() ">Получить данные о Морти Смит с помощью JQuery</button><br/><br/>
<button style = "width: 400px" onclick = "test2()">Получить данные о Морти Смит с помощью JQuery</button><br/><br/>
<!--<table>-->
<!--    <thead id="thead">-->
<!--    </thead>-->
<!--    <tbody id="tbody"></tbody>-->
<!--</table>-->



</body>
</html>
